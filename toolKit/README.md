# 鸿蒙工程化开发思考

> 从工程化角度，按【基础夯实→模块设计→核心工具→工程规范→部署测试】来梳理核心 的 ToDo 清单，适配多模块工程化项目开发需求。

## 一、鸿蒙基础能力补全

1. **ArkTS 进阶语法夯实**：掌握 `interface/type/class` 类型定义、泛型、装饰器（`@State/@Link/@Provide` 等状态管理）、异步编程（`Promise/async/await` 优化网络 / 数据库请求）。

2. **组件化进阶**：自定义公共组件（封装顶部导航栏、弹窗等通用组件，多模块复用）、组件生命周期（`aboutToAppear/aboutToDisappear` 处理模块间组件销毁逻辑）、组件通信。

3. **路由与页面管理**：使用鸿蒙最新的路由相关的 API（`pushUrl/replaceUrl`）等，实现多模块页面跳转、参数传递（比如用户模块跳课程模块带用户 ID）、路由守卫（未登录拦截跳登录页）。

4. **资源统一管理**：掌握 `resource-manager`  API，实现多模块共享资源（字符串、图片、颜色），避免重复资源，按模块划分资源目录（如 `common/resource` 存公共资源）。

## 二、多模块架构设计

1. **模块边界定义**：明确各模块职责（公共模块仅暴露工具 / 组件，不包含业务逻辑；功能模块独立实现业务，依赖公共模块不跨模块依赖），编写模块接口文档（比如公共模块导出哪些工具类，功能模块提供哪些调用方法）。

2. **模块依赖配置**：熟练使用 `oh_package.json5` 配置依赖（`dependencies` 引入模块路径，`peerDependencies` 声明公共依赖），解决模块依赖冲突（比如多模块依赖同一个第三方库，保证版本统一）。

3. **数据模型统一**：在公共模块定义全局数据模型（`User.ts/Course.ts`），使用 `class` 或 `interface` 标准化定义数据结构，确保各模块数据传递一致性（避免同一数据在不同模块定义不同格式）。

## 三、核心工具封装

1. **网络请求封装**：基于鸿蒙原生网络请求 `fetch` 或 `axios-ohos`，在公共模块封装统一网络请求（请求拦截器加 Token、响应拦截器统一错误处理、请求超时配置），多模块直接调用无需重复编写。

2. **本地存储管理**：使用鸿蒙 用户首选项`Preferences`（键值对存储），封装公共存储工具（比如 `StorageUtil` 存用户 Token、隐私协议是否已读、学习进度等），支持多模块读写权限控制。

3. **状态管理**：使用鸿蒙 `AppStorage` 或第三方库（如 `pinia-ohos`），管理全局状态（用户登录状态、全局加载状态），解决多模块状态共享（比如在用户模块登录后，课程 / 学习模块要能同步获取用户信息）。

4. **权限处理**：封装公共权限工具（`PermissionUtil`），处理多模块所需权限（如网络权限、存储权限、位置权限），统一权限申请弹窗、权限拒绝后的引导逻辑。

## 四、工程化规范

1. **代码规范制定**：使用 ESLint + Prettier 配置鸿蒙 ArkTS 代码规范（变量命名、函数注释、代码缩进），确保多模块代码风格一致，避免后期维护混乱。

2. **构建与打包配置**：熟悉 DevEco Studio 多模块构建流程，配置 `build-profile.json5`（指定编译模块、输出路径、混淆配置），实现单模块编译测试、全模块打包发布。

3. **版本控制与分支管理**：按模块划分 Git 分支（`feature/user`/`feature/course`），制定分支合并规则（开发完合并到 `develop` 分支，测试通过合并到 `main`），避免多模块开发代码冲突。

## 五、测试与问题排查

1. **单模块单元测试**：使用鸿蒙 `unittest` 框架，为公共模块工具类、功能模块核心逻辑编写单元测试（比如测试公共工具类的字符串处理、网络请求的响应处理）。

2. **模块间集成测试**：测试模块依赖是否正常、数据传递是否正确（比如用户模块登录后，学习模块能否获取到正确的用户信息）、跨模块页面跳转是否流畅。

3. **日志与埋点封装**：在公共模块封装日志工具（`LogUtil`），支持不同模块日志分类（`TAG: Common`/`TAG: User`），方便排查多模块联调问题；集成埋点（如华为分析服务）统计核心行为。

## 六、性能与兼容性优化

1. **多模块性能优化**：解决模块间资源重复加载（公共组件懒加载）、页面跳转卡顿（路由预加载）、内存泄漏（组件销毁时取消网络请求 / 定时器）。

2. **设备兼容性适配**：按鸿蒙最新设备类型（手机、平板、智慧屏）配置多模块适配规则，使用 `mediaquery` 实现响应式布局，确保各模块在不同设备上正常显示。
